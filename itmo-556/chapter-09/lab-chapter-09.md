Chapter 09 Lab
----------------------------------------------------------------------------------------------------------------------------------------

Name: Sonita Bose

Course: ITMO-556-01 Introduction to Open Source Software

CWID: A20447922

---
# LAB 9 – OSS

---

## 1. What would be the command to add a user named "controller" to your system - using the system default values?
sudo addsuer controller 

sudo addsuer controller 

 ![1](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/1-9.JPG)

 
---

## 2. What would be the command to modify the user's group to add them to a superuser group (sudo on Ubuntu or wheel on Fedora based)?
sudo usermod -aG sudo controller 
groups controller

 ![2](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/2-9.JPG)

---

## 3. What would be the command to delete a user account named nsa-spy? (Note you also have to include the steps to add this user... unless the NSA is already in your system =)

sudo addsuer controller 
sudo deluser nsa-spy

 ![3](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/3-9.JPG)
---

## 4. What would be the command to edit the /etc/sudoers file and give the user "mysql-backup" sudo privilege? (Show the /etc/sudoers being edited and enter the relevant line that you add to that file)

sudo visudo
mysql-backup ALL=(ALL:ALL) ALL
  
 ![4](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/4-9.JPG)

---

## 5. What would be the command to edit the /etc/sudoers file and give the group "mysql-admins" sudo privilege? (Show the /etc/sudoers being edited and enter the relevant line that you add to that file)

%mysql-admins ALL=(ALL:ALL)  ALL
 
 ![5](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/5-9.JPG)
---

## 6What would be the command to edit the /etc/sudoers file to give the user "mysql-admin" sudo privilege to only use the mysql database backup command "mysqldump" ? (Show the /etc/sudoers being edited and enter the relevant line that you add to that file)

mysql-admin ALL=(root) : /usr/bin/mysqldump

---

## 7. What would be the command to edit the /etc/sudoers file to give the user "mysql-admin" sudo privilege to only execute the mysql command and not require a password? 


mysql-admin ALL=(root) NOPASSWD: /usr/bin/mysql

---

## 8. When you execute the command tail journalctl - you receive an error? Show the error in a screenshot and explain why the error comes?

Tail is used to tail a file. 
Journalctl is an executable file. 
You can use journalctl -f to tail syslogs

 ![8](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/8-9.png)

---

## 9. What would be the command to execute to find all the occurences of logs generated by SSHD in journalctl? P.168 in the text book -- you may need to install openssh-server package if the command returns no results

Journalctl /usr/sbin/sshd
 
 ![9](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/9-9.JPG)
---

## 10. What would be the command to execute to find all the logs generated by _PID=1 (systemd itself) and since yesterday?

journalctl _PID=1 –since yesterday

![10](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/10-9.JPG)
---

## 11. What would be the command to execute to see the logs of the current boot only using journalctl?
 journalctl -b
 
 ![11](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/11-9.JPG)
---

## 12. Which file and what value would I modify to change the journal's settings to make the logs be stored in memory (volatile)?
File to be changed would be journald.conf  and would change storage =volatile
 ![12](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/12-9.JPG)
---

## 13. The journald values SystemMaxUse= and RuntimeMaxUse= default to 10% and 15% of the system disk respectively. How would you modify that value to be 20% and 30% respectively? (Note you can't add percentages, you have to use your system and do some scratch math - you can execute a df -H command to see the size of your root partition)
Total disk size = 22 G
Available disk size = 11 G

20% of 11GB = 2.2G SystemMaxUse=2.2G  2G
30% of 11GB= 3.3G RuntimeMaxUse=3.3G 3G

 ![12](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/13.9.JPG)

---

## 14. What would be the command to edit the cron service and run this command "mysqldump --xml -u root world City" (Assume you have mysql installed) at 2 am every Sunday?
Line below needs to be inserted in the /etc crontab

	* 2 * * 0 /usr/sbin/mysqldump --xml -u root world City

---

## 15. What would be the command to edit the cron service and run this command "mysqldump --xml -u root world City" (Assume you have mysql installed) at the 1st day of every month?
Line below needs to be inserted in the /etc crontab

	* * 1 * * /usr/sbin/mysqldump --xml -u root world City

---

## 16. What would be the command to edit the cron service and run this command "mysqldump --xml -u root world City" (Assume you have mysql installed) every 45 minutes?
Line below needs to be inserted in the /etc crontab
         */45 *  *  *  * /usr/sbin/mysqldump --xml -u root world City

---

## 17. What would be the command to edit the cron service and run this command "mysqldump --xml -u root world City" (Assume you have mysql installed) on every 45 minutes past the hour on Sundays? 1:45 2:45
Line below needs to be inserted in the /etc crontab

 	45 *  *  *  0 /usr/sbin/mysqldump --xml -u root world City

---

## 18. What would be the command to edit the cron service and run this command "mysqldump --xml -u root world City" (Assume you have mysql installed) at 2:45am on this coming Tuesday only?
Line below needs to be inserted in the /etc crontab
45 2 22  10  2 /usr/sbin/mysqldump --xml -u root world City
 
 ![18](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/18-9.png)
---

## 19. What command would you use to change the group ownership of the file todo-list.txt to be owned by the "accounting" group? (If that group doesn't exist then create it on your system)

 ![19](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/19-9.JPG)
 ![19](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/19-9-B.JPG)
 
---

## 20. What would be the command you would type to generate a RSA key pair?
ssh-keygen
 
 ![20](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/20-A-9.JPG)
 ![20](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/20-B-9.JPG)
 
---

## 21. What would be the command to transfer an RSA key pair to a remote system named logserver with the username worker?

ssh-copy-id worker@logserver

---

## 22. What would be the command to connect via ssh using the identity logserver and connect to the non-standard port of 5555 instead of the default 22?
 
 ![22](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/22-9.JPG)
---

## 23. The next questions require some setup: i. You need two virtual mahcines for this part: One Ubuntu based and one Fedora based (or two comparablely different OSes, FreeBSD, Trisquel, etc etc).
i. You will need to modify the Network settings to Bridged in Virtualbox to get a public IP (if you are at home your router should suffice, if you are on campus you can come to the lab).
i. Install openssh-server on Fedora. i. Clone the repository https://github.com/arthepsy/ssh-audit to both the client and server system i. Run the ssh audit on the client and server, list the weak ciphers installed by default
 
  ![23](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/23-9A.JPG)
   ![23](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/23-B-9.JPG)
   
---

## 24. Modify the client and servers using the example in the text to increase cipher strength, run the ssh-audit tool again and report any weak ciphers or security anomolies.
Please find the config files attached as auditubuntu1 and auditubuntu2 for Ubuntu and auditfedora1 and auditfedora2 for Fedora

 ![24](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/24-9.JPG)
 ![24](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/24-B-9.png)
           
---

## 25. On the SSH server make the following changes to the sshd_config file and paste them at the end of the ReadMe.md file i. Not accept any password based authentication attempts i. Change the default port to be 5555 i. Disable the value PermitRootLogin
 ![25](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/9-25.png)
---

## 26. Install fail2ban on both of the above systems.
i. Configure fail2ban to start the service and enable it via systemctl command.
ii. Configure the fail2ban to parse the systemd jounrnalctl logs 
iii. From the first system (Ubuntu) try to SSH into the second system (Fedora) with an incorrect username and password 5 times and get yourself banned. 
iv. Submit the fail2ban config file to blackboard as part of the deliverable.
Ubuntu
sudo apt-get install -y fail2ban 
sudo systemctl start fail2ban
sudo systemctl enable fail2ban
Fedora 
Sudo apt install fail2ban
 
 


 ![26](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/26-9-a.JPG)

ii) Configure the fail2ban to parse the systemd jounrnalctl logs 

Ubuntu
 ![26](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/26-E-9.png)
 
 Fedora
 ![26](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/26iiFEd.JPG)
 
 iii) screenshot of getting banned
 ![26](https://github.com/illinoistech-itm/sbose10/blob/master/images/chapter-09/26-D-9.png)
 
 iv)attached the config file and named as fail2banconfig

---
